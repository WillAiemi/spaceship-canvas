<!DOCTYPE html>
<html>

    <head>
        <title>Background with Parallax</title>
        <script src="js/animation.js"></script>
        <script src="js/background.js"></script>
        <script src="js/spaceship.js" charset="utf-8"></script>
        <script src="js/keyboard.js" charset="utf-8"></script>
        <script src="js/spritesheet.js" charset="utf-8"></script>
        <script src="js/projectile.js" charset="utf-8"></script>
        <script src="js/control.js" charset="utf-8"></script>
        <script src="js/ovni.js" charset="utf-8"></script>
        <script src="js/explosion.js" charset="utf-8"></script>
    </head>
    <body>

        <canvas id="canvas" width="500" height="500"></canvas>
        <script>
            var imgSpace = new Image();
            imgSpace.src = 'img/space-background.png';

            var imgStars = new Image();
            imgStars.src = 'img/stars-background.png';

            var imgClouds = new Image();
            imgClouds.src = 'img/clouds-background.png';

            var imgSpaceship = new Image();
            imgSpaceship.src = 'img/spaceship-spritesheet.png';

            var loaded = 0;
            var total = 4;

            imgSpace.onload = load;
            imgStars.onload = load;
            imgClouds.onload = load;
            imgSpaceship.onload = load;

            function load() {
                loaded++;
                if (loaded == total) start();
            }

            function start() {
                var canvas = document.getElementById('canvas');
                var context = canvas.getContext('2d');
                var keyboard = new Keyboard(document);
                var control = new Control(context);
                var animation = new Animation(context);
                control.animation = animation;
                animation.control = control;

                // Context and image to the objects Background
                var backgroundSpace = new Background(context, imgSpace);
                var backgroundStars = new Background(context, imgStars);
                var backgroundClouds = new Background(context, imgClouds);

                var spaceship = new Spaceship(context, keyboard, imgSpaceship, control);

                // Each with a different speed
                backgroundSpace.speed = 3;
                backgroundStars.speed = 7;
                backgroundClouds.speed = 10;
                spaceship.speed = 5;
                spaceship.x = canvas.width / 2 - imgSpaceship.width / 4;
                spaceship.y = canvas.height * 2 / 3;

                animation.newSprite(backgroundSpace);
                animation.newSprite(backgroundStars);
                animation.newSprite(backgroundClouds);
                animation.newSprite(spaceship);
                keyboard.addClickListener(SPACE, function() {
                    spaceship.shoot();
                });
                animation.turnOn();
            }
       </script>
    </body>

</html>
